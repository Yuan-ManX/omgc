# Open Music Game Chart

Open Music Game Chart，简称OMGC，是一个开放通用的音乐游戏谱面中间格式。OMGC支持所有广义下落式音游的谱面，提供了游戏无关的通用表达格式，在提供通用抽象描述的同时，也能保留各个原始谱面的自定义特性。OMGC格式的谱面可以从任意符合要求的音游谱面导入，也可以导出为任意支持的其它谱面格式。

## 广义下落式音游

### 什么是广义下落式音游

广义下落式音游针对传统上下落式音游的形式进行归纳，抽象出若干核心要素，只要满足以下条件，即可判定为广义下落式音游：

* 以**音符**(note)为基本要素，通过点击、滑动等方式对音符进行操作的音乐节奏游戏

*  每一首歌有一个音符集合体，称之为**谱面**(chart)，谱面定义了每个音符从出现到最终消失的具体行为。谱面可以为固定的，也可以根据规则在一定范围内发生变动

*  谱面拥有若干个**音符源**(note source)，可以根据规则生成音符。音符源可以只有一个（如SIF），也可以有多个（大多数有轨下落式）或者随机（无轨下落式）。

    通常音符源产生音符后，音符会进行移动，即“下落”，移动方向并没有限制，可以横向移动，无规则运动甚至在3D空间运动。但音符也可以固定不动，此时必须要有某种机制（例如移动判定区域）来进行触发
*  谱面拥有若干个**判定区域**(judge area)，可以是单独一根线，也可以是几个轨道，也可以是是几个封闭区域，甚至至有一个点。判定区域可以移动和发生各种变化。

*  谱面拥有若干个**打击区域**(hit area)，打击区域可以和判断区域相同，也可以不一致，甚至毫无关联（如太鼓达人）。打击区域也可以移动或发生其他变化。

### 哪些游戏算/不算广义下落式音游
* 通常所说的狭义有轨/无轨下落式，例如以下：

    |游戏|音符源数|键/轨道数|判定和打击区域|
    |--|--|--|--|
    |LoveLive!SIF |1|9|9键位|
    |BangDream     |7|7|7键位|
    |节奏大师       |4/5/6|4/5/6|4/5/6轨道|
    |CGSS/MLTD     |2/5|2/5|2/5键位|
    |Deemo         |纵向随机|无轨|1判定线|
    |Phigrous      |任意方向随机|无轨，但可以模拟成有轨甚至 <s>坐 标 系</s>|任意自然数条判定线（可以为0<s>黄键当判定</s>），音符垂直于判定线的整个区域均可打击|

* 不像下落式的下落式
    * Muse Dash、太鼓达人这些横向“下落”的音游
    * Malody的Ring模式，maimai，SIF AC
    * <s>Phigros的某些IN</s>
* 基本符合定义，但是谱面转换为其它游戏难以游玩，这些一般不考虑
    * osu!、Cytus II等出现式/扫线式音游
    * jubeat这种完全固定打击位置的
* 大多数“一指禅”音游，例如 冰与火之歌。虽然这些游戏画面中有判断区域，也可以制作“谱面”，但通常没有note的概念，交互方式也与一般游戏不同

-----

## OMGC谱面格式

### 文件格式

OMGC谱面只提供数据结构定义，实际储存格式并无具体限制。
* 纯谱面

    一般可以用XML、JSON、JSON5或者YAML来存储纯文本结构，必要时也可采用INI、TOML或者RESP协议等其他可以包含嵌套结构的纯文本格式，但不应该使用Protobuff、MessagePack等二进制序列化格式。

    纯谱面文件名为 `*.omgc.<format suffix>`，例如mymusic.omgc.json，对应的MIME类型为`application/omgc+json`。
    
* 包含歌曲，封面等的二进制打包谱面

    推荐使用基于**开放打包约定**(Open Packaging Conventions, OPC)，或者**开放容器格式**(Open Container Format, OCF)等的自描述容器格式，储存标准ZIP压缩文件。纯文本谱面文件必须位于容器的根目录中，以便于在没有容器结构解析工具的情况下找到谱面本体。

    打包谱面可以通过添加签名校验、证书认证、数字水印、文件自定义属性等方式进行版权声明和授权验证，但不能使用创建解压密码等方式阻止文件内容读取。

    二进制谱面文件名为 `*.omgb`，例如mymusic.omgb，对应的MIME类型为`application/omgb+zip`

###  [谱面定义](format.md)